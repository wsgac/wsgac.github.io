<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-04-14 Fri 12:31 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>wsg - non-random wandering</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Wojciech S. Gac" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/solarized-dark.min.css" />

<script type="text/javascript" src="js/org-info.js">
/**
 *
 * @source: js/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in js/org-info.js.
 *
 * Copyright (C) 2012-2013 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in js/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "2");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">wsg - non-random wandering</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#emacs-hacking">Emacs hacking</a>
<ul>
<li><a href="#org-mode-bundled-sync">Org-mode file bundled with executable synchronization code</a></li>
</ul>
</li>
<li><a href="#hardware-configuration">Hardware Configuration</a>
<ul>
<li><a href="#the-zen-of-trackball-configuration">The Zen of trackball configuration</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgef39310" class="outline-2">
<h2 id="emacs-hacking"><a id="orgef39310"></a>Emacs hacking</h2>
<div class="outline-text-2" id="text-emacs-hacking">
</div>

<div id="outline-container-orgba6b40f" class="outline-3">
<h3 id="org-mode-bundled-sync"><a id="orgba6b40f"></a>Org-mode file bundled with executable synchronization code</h3>
<div class="outline-text-3" id="text-org-mode-bundled-sync">
<p>
I've been experimenting for a while with ways to get some kind of
file synchronization mechanism for my Org-mode files, without
having to resort to Dropbox, Google Drive or the likes. I started
out by writing some Elisp code to handle the sync process for me,
but than tried an alternative approach. I figured, since Org-mode
allows me to have executable source code blocks, I could use that -
combined with a certain degree of introspection on the Org file's
part - to <code>bundle</code> synchronization functionality with the file
itself.
</p>

<p>
For starters, I wanted to store the path to the remote file<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>
(to which I'll be synchronizing) as a named field. This can be done
e.g. using <code>#+BEGIN_EXAMPLE</code>:
</p>
<div class="org-src-container">
<pre class="src src-org">#+name: remote-path
#+BEGIN_EXAMPLE
  /scp:&lt;my-remote-hostname&gt;:/path/to/my/remote/file.org
#+END_EXAMPLE
</pre>
</div>
<p>
Having such a snippet in my file will allow me to refer to its
content using the identifier <code>remote-path</code>.
</p>

<p>
Next, I added an Elisp snippet that syncs the file out to the
remote location:
</p>
<div class="org-src-container">
<pre class="src src-org">#+name: push
#+BEGIN_SRC emacs-lisp :var remote=remote-path :results output silent
  (save-buffer (current-buffer))
  (make-directory (file-name-directory remote) t)
  (copy-file buffer-file-name
             remote 1)
  (message "Synced file to %s" remote)
#+END_SRC
</pre>
</div>
<p>
Let's have a quick rundown of the snippet. First of all, I've
called it <code>push</code> for easy reference (to be used later). I used the
<code>:var</code> keyword to define a block-local binding available for use
in the code (in my case a variable <code>remote</code> bound to the value of
<code>remote-path</code> - my <code>#+BEGIN_EXAMPLE</code> block above). The <code>:results
   output silent</code> bit avoids inserting the results of code execution
into the file. What the actual code does is:
</p>
<ul class="org-ul">
<li>ensure the buffer is saved</li>
<li>ensure the remote directory exists</li>
<li>do the actual copy</li>
<li>generate a message to the user</li>
</ul>

<p>
I also added a mirror image of the above snippet - in charge of
copying changes <i>from</i> the remote server:
</p>
<div class="org-src-container">
<pre class="src src-org">#+name: pull
#+BEGIN_SRC emacs-lisp :var remote=remote-path :results output silent
  (save-buffer (current-buffer))
  (copy-file remote buffer-file-name 1)
  (revert-buffer t t)
  (message "Synced %s to file" remote)
#+END_SRC
</pre>
</div>
<p>
Again, a rundown:
</p>
<ul class="org-ul">
<li>save current buffer</li>
<li>copy the remote file to local file system</li>
<li>revert contents of the current buffer</li>
<li>generate a message to the user</li>
</ul>

<p>
Now, this in itself already does the trick, but it requires you to
navigate to the appropriate code block, depending on which action
you want. What seemed to me the natural next step was to have some
code in my <code>.emacs</code> file that would make it easier by automatically
finding the right code block and executing it. This turned out to
be relatively simple. I came up with the following Elisp function:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun org-sync-current-file (prefix)
  (interactive "P")
  (let ((action
   (cl-case prefix
     ((nil) "push")
     (t "pull"))))
    (save-excursion
      (org-babel-goto-named-src-block action)
      (org-ctrl-c-ctrl-c))))
</pre>
</div>
<p>
I decided for the function to dispatch based on the prefix
argument: no prefix means <code>push</code>, prefix means <code>pull</code>. The function
retrieves the appropriate code block - either <code>push</code> or <code>pull</code> -
and executes it. Depending on your Org-mode settings, Emacs might
at this point ask you for confirmation before actually executing
the code. One final touch to make this more usable is to pick some
reasonable key binding. In my case <code>F12</code> seemed a decent choice:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(define-key global-map (kbd "&lt;f12&gt;") 'org-sync-current-file)
</pre>
</div>

<p>
The above solution might not be what you'd consider a reliable
synchronization system. Rather, it should be regarded as an
interesting - if somewhat contrived - exercise in blurring the
lines between data and behavior. 
</p>
</div>
</div>
</div>

<div id="outline-container-org11481fe" class="outline-2">
<h2 id="hardware-configuration"><a id="org11481fe"></a>Hardware Configuration</h2>
<div class="outline-text-2" id="text-hardware-configuration">
</div>

<div id="outline-container-org582bdbf" class="outline-3">
<h3 id="the-zen-of-trackball-configuration"><a id="org582bdbf"></a>The Zen of trackball configuration</h3>
<div class="outline-text-3" id="text-the-zen-of-trackball-configuration">
<p>
Ever since I saw them in a Logitech marketing booklet as a kid,
I've been fascinated by trackballs. I would sometimes say to
myself: How cool! Instead of moving the mouse, here you move the
whole Universe to get the cursor to do your bidding. I tried
imagining how much fun using one would be. The prices, however,
were prohibitively high for a kid's whim. Then one day, many years
later, I saw the Logitech Trackman Marble discounted at a nearby
store and bought it without thinking twice. It was everything I
imagined it would be and more. Getting used to the new way of doing
things took me around 15 minutes. Another day and I felt
proficient. Having by then already switched to GNU/Linux, I was
confronted by the question of configuring this thing under
Xorg. This part turned out to also be fun, but with a much more
masochistic touch :). Below I'll describe my standard configuration
for the Trackman Marble and make some more general comments about
key mapping. Recently I bought another trackball - the CST 2545-5W
Laser Trackball. The principles underlying its configuration remain
unchanged, although a different button layout necessitates some changes.
</p>


<div class="figure">
<p><img src="img/logitech-trackman-marble.jpg" alt="logitech-trackman-marble.jpg" width="600 px" />
</p>
<p><span class="figure-number">Figure 1: </span>Logitech Trackman Marble</p>
</div>

<p>
The Xorg configuration for trackballs resides in a file
<code>10-evdev.conf</code>. On Debian derivatives, such as Ubuntu, this file
is typically located in <code>/usr/share/X11/xorg.conf.d</code>. For systems
with a more traditional file layout (such as OpenBSD) a good place
to put the configuration might also be <code>/etc/X11/xorg.conf</code>. Here's
the configuration bit:
</p>
<pre class="example">
Section "InputClass"
    Identifier   "Logitech USB Trackball"
    # MatchVendor  "Logitech"
    MatchProduct "Trackball"
    Option       "ButtonMapping"      "1 8 3 4 5 6 7 2 8"
    Option       "EmulateWheel"       "True"
    Option       "EmulateWheelButton" "8"
    Option       "ZAxisMapping"       "4 5"
    Option       "XAxisMapping"       "6 7"
    Option       "Emulate3Buttons"    "true"
EndSection
</pre>
<p>
Let's quickly go through various items in that entry:
</p>
<ul class="org-ul">
<li><code>Identifier</code> and <code>MatchProduct</code> match a particular model's
information (as discoverable using <code>lsusb</code>).</li>
<li><code>ButtonMapping</code> specifies which physical buttons will emit which
button actions. More on this below.</li>
<li><code>EmulateWheel</code> determines whether there should be a button which
will make the ball act as a 2-dimensional scroll wheel instead of
moving the cursor.</li>
<li><code>EmulateWheelButton</code> - which button should that be (in my case -
small left button).</li>
<li><code>ZAxisMapping</code> and <code>XAxisMapping</code> - which button actions (or ball
motions) should scroll in different directions.</li>
<li><code>Emulate3Buttons</code> - whether pressing both LMB and RMB
simultaneously should emulate the middle button.</li>
</ul>
<p>
What this means in practice is roughly this - the two large buttons
function as ordinary mouse buttons, the small left button enables
2D scrolling and the small right button is browser "back".
</p>


<div class="figure">
<p><img src="img/cst-trackball.jpg" alt="cst-trackball.jpg" width="600 px" />
</p>
<p><span class="figure-number">Figure 2: </span>CST 2545-5W</p>
</div>

<p>
The CST 2545-5W trackball has a different anatomy and hence the
settings I chose for it differ slightly from the Logitech
model. Specifically, it has a physical scroll wheel, so the wheel
emulation feature is not that important. But I still chose to
enable it, this time using the physical middle button. Here's the
configuration:
</p>
<pre class="example">
Section "InputClass"
    Identifier   "Clearly Superior Technologies. CST Laser Trackball"
    # MatchVendor  "Clearly Superior Technologies."
    MatchProduct "Trackball"
    Option       "ButtonMapping"      "1 2 3 4 5 6 7 8 9"
    Option       "EmulateWheel"       "True"
    Option       "EmulateWheelButton" "2"
    Option       "ZAxisMapping"       "4 5"
    Option       "XAxisMapping"       "6 7"
    Option       "Emulate3Buttons"    "true"
EndSection
</pre>

<p>
To wrap up I'll briefly describe what the different numbers used
for mapping actually stand for. This is the result of perusing
various resources on the web, supplemented with using the
invaluable <code>xev</code> tool. In the option <code>ButtonMapping</code> positions
correspond to the following physical buttons/movements:
</p>
<pre class="example">
1 - Left Button
2 - Both Buttons
3 - Right Button
4 - Ball Down
5 - Ball Up
6 - Ball Left
7 - Ball Right
8 - Small Left Button
9 - Small Right Button
</pre>
<p>
while the numbers occupying those positions correspond to the
following actions:
</p>
<pre class="example">
1 - Left Click
2 - Middle Click
3 - Right Click
4 - Cursor Down
5 - Cursor Up
6 - Cursor Left
7 - Cursor Right
8 - Browser Back
9 - Browser Forward
</pre>
<p>
One final remark is that the number given to <code>EmulateWheelButton</code>
is the actual physical button, so regardless of your mapping above,
<code>"8"</code> will still refer to the <code>Small Left Button</code>.
</p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
It helps to have a permanent entry for your remote server in
your <code>~/.ssh/config</code> file and SSH key-based authentication
enabled. Otherwise, you're going to have to use entries of the form
<code>user@host#port</code> and/or have to type your password each time you do
the sync.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Wojciech S. Gac</p>
<p class="date">Created: 2017-04-14 Fri 12:31</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
